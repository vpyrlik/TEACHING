---
title: "Семинар 3. Задание."
date: '2022-09-20'
output:  
  html_document:  
    self_contained: no  
    theme: cosmo
    toc: true
    toc_float: true
    toc_collapsed: true
    toc_depth: 2
mainfont: Liberation Serif
monofont: Liberation Mono
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Часть 1. Упражнения

## SW, глава 4, упражнение 4.3 (а, б, г, д)
Регрессия средней недельной зарплаты ($AWE$, измеренной в долларах) от возраста ($Age$, измеренного в годах) на основе случайной выборки 25–65-летних людей с высшим образованием и работающих полный рабочий день приводит к следующему:

$$\hat{AWE} =  696.7 + 9.6 \times Age$$

а. Объясните значение коэффициентов 696.7 и 9.6.

б. Стандартная ошибка регрессии (SER) равна 624.1. Каковы единицы измерения SER? (Доллары? Годы? Или SER безразмерна?)

в. ---

г. Чему равно предсказанное по регрессии значение зарплаты для 25-летнего работника? Для 45-летнего работника?

д. Будет ли регрессия давать надежное предсказание зарплаты для 99-летнего работника? Почему да или почему нет?

## SW, глава 4, упражнение 4.9
а. Известно, что оценка коэффициента наклона в модели парной линейной регрессии равна $\hat \beta_1 = 0$. Покажите, что $R^2 = 0$.

б. Теперь известно, что $R^2 = 0$. Предполагает ли это, что $\hat \beta_1 = 0$?

## SW, глава 4, упражнение 4.10 (а)
Предположим, что $Y_i = \beta_0 + \beta_1 X_i + u_i$, где ($X_i$, $u_i$) является i.i.d., и $X_i$ является случайной величиной Бернулли с $Pr(X = 1) = 0.20$. Когда $X = 1$, $u_i$ имеет вид $N(0, 4)$; когда $X = 0$, $u_i$ имеет вид $N(0,1)$.

а. Покажите, что предположения метода наименьших квадратов из вставки "Основные понятия 4.3" выполнены.

## SW, глава 4, упражнение 4.11 (а)
Рассмотрим модель парной линейной регрессии $Y_i = \beta_0 + \beta_1 X_i + u_i$.

а. Предположим, вы знаете, что $\beta_0 = 0$. Выведите формулу оценки наименьших квадратов для $\beta_1$.

## SW, глава 4, упражнение 4.14
Покажите, что линия выборочной регрессии проходит через точку $(\bar X, \bar Y)$.


# Часть 2. Эмпирический пример

## Исследовательский вопрос
Ваша задача --- ответить на вопрос: *правда ли, что дополнительная работа плохо сказывается на сне?*

Предварительно обсудите, есть ли смысл изучать эту взаимосвязь. Какие еще факторы могут влиять на сон? Сформулируйте гипотезу для исследовательского вопроса и механизм ее объясняющий.

## Загрузка пакетов

Не забудьте загрузить необходимые пакеты.

```{r, message=FALSE}
library(wooldridge) # пакет содержит наборы данных, используемые в учебнике Wooldridge
# ...самостоятельно выберите пакеты для работы с данными...
library(lmtest)     # тестирование гипотез
library(broom)      # удобное представление результатов тестов и регрессий
```

## Набор данных

На этом семинаре мы продолжаем работать с данными [о продолжительности сна и распределении времени](https://www.rdocumentation.org/packages/wooldridge/versions/1.4-2/topics/sleep75). Фрагмент данных можно загрузить, используя встроенный набор данных пакета [wooldridge](https://www.rdocumentation.org/packages/wooldridge/versions/1.4-2) (используйте набор данных `sleep75`).

```{r}
data("sleep75")
```

Изучите загруженные данные. Обсудите, какие переменные лучше всего подходят для ответа на поставленный исследовательский вопрос.

## Разведывательный анализ данных

Проведите разведывательный анализ данных: 

1. Постройте таблицу с описательными статистиками основных переменных.

2. Постройте графики, визуализирующие изучаемую взаимосвязь.

3. Можете провести дополнительный разведывательный анализ на свое усмотрение.

## Регрессионный анализ

Проведите регрессионный анализ взаимосвязи между переменными сна и работы: 

1. Оцените модель парной регрессии в полуавтоматическом режиме, используя функции `mean()`, `cov()`, `var()` и т. д. 
2. Оцените модель парной регрессии в автоматическом режиме, используя функцию `lm()` для оценки. 

3. Выведите полученные результаты при помощи базовой функции `summary()`. Эта команда не всегда удобно, так что в качестве альтернативы или дополнения рекомендуется использовать функцию `tidy()` из пакета `broom`. Также дополнительные возможности дает использование функции `coeftest()` из пакета `lmtest`, в частности опция `df = Inf` позволяет проводить асимптотические тесты в отношении коэффициентов вместо конечновыборочных. 

3. Проинтерпретируйте полученные результаты (особое внимание уделите оценке коэффициента при регрессоре).

4. Проведите анализ значений зависимой переменной, предсказанных моделью. Для этого можно использовать функцию `fitted()`. Дополнительные возможности дает использование функции `augment()` из пакета `broom`. Также полезно визуализировать линию регрессии, нанеся ее на соответствующую диаграмму рассеяния (это можно сделать в `ggplot`автоматически с использованием функции `geom_smooth()` или в полуавтоматическом режиме с использованием функций `geom_line()` или `geom_abline()`). 
